[参考](https://towardsdatascience.com/head-pose-estimation-using-python-d165d3541600)
ほしい座標(変数)の下に以下を書いてね
x1.append
y1.append
z1.append

「num = dt_now.microsecond」にすることで、時系列で保存できるよ

```realtime_direction.py
import cv2
import mediapipe as mp
import numpy as np
import csv
import datetime

dt_now = datetime.datetime.now()
#num = dt_now.microsecond
#num = 0

mp_face_mesh = mp.solutions.face_mesh
face_mesh = mp_face_mesh.FaceMesh(min_detection_confidence=0.5, min_tracking_confidence=0.5)
cap = cv2.VideoCapture(0)

body = []

time = []
num = 0
time.append("time")

direction = []
direction.append("direction")

x1 = []
x1.append("x")
y1 = []
y1.append("y")
z1 = []
z1.append("z")

while cap.isOpened():
    success, image = cap.read()

    # Flip the image horizontally for a later selfie-view display
    # Also convert the color space from BGR to RGB
    image = cv2.cvtColor(cv2.flip(image, 1), cv2.COLOR_BGR2RGB)

    # To improve performance
    image.flags.writeable = False

    # Get the results
    results = face_mesh.process(image)

    # To improve performance
    image.flags.writeable = True

    # Convert the color space from RGB to BGR
    image = cv2.cvtColor(image, cv2.COLOR_RGB2BGR)

    img_h, img_w, img_c = image.shape
    face_3d = []
    face_2d = []

    if results.multi_face_landmarks:
        for face_landmarks in results.multi_face_landmarks:
          for idx, lm in enumerate(face_landmarks.landmark):
              if idx == 33 or idx == 263 or idx == 1 or idx == 61 or idx == 291 or idx == 199:
                if idx == 1:
                  nose_2d = (lm.x * img_w, lm.y * img_h)
                  nose_3d = (lm.x * img_w, lm.y * img_h, lm.z * 8000)

                x, y = int(lm.x * img_w), int(lm.y * img_h)

                # Get the 2D Coordinates
                face_2d.append([x, y])

                # Get the 3D Coordinates
                face_3d.append([x, y, lm.z])

          # Convert it to the NumPy array
          face_2d = np.array(face_2d, dtype=np.float64)

          # Convert it to the NumPy array
          face_3d = np.array(face_3d, dtype=np.float64)

   	    # The camera matrix
          focal_length = 1 * img_w

          cam_matrix = np.array([ [focal_length, 0, img_h / 2],
                                  [0, focal_length, img_w / 2],
                                  [0, 0, 1]])

	    # The Distance Matrix
          dist_matrix = np.zeros((4, 1), dtype=np.float64)
	    # Solve PnP
          success, rot_vec, trans_vec = cv2.solvePnP(face_3d, face_2d, cam_matrix, dist_matrix)

	    # Get rotational matrix
          rmat, jac = cv2.Rodrigues(rot_vec)

	    # Get angles
          angles, mtxR, mtxQ, Qx, Qy, Qz = cv2.RQDecomp3x3(rmat)

	    # Get the y rotation degree
          x = angles[0] * 360
          y = angles[1] * 360
          z = angles[2] * 360
          time.append(num)
          print(num)
          x1.append(x)
          y1.append(y)
          z1.append(z)

          # See where the user's head tilting
          if y < -10:
              text = "Looking Left"
              direction.append(text)
              print(num, text, x, y)
          elif y > 10:
              text = "Looking Right"
              direction.append(text)
              print(num, text, x, y)
          elif x < -10:
              text = "Looking Down"
              direction.append(text)
              print(num, text, x, y)
          else:
              text = "Forward"
              direction.append(text)
              print(num, text, x, y)
          
          # Add the text on the image
          cv2.putText(image, text, (20, 20), cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 0, 255), 2)
          
          # Display the nose direction
          nose_3d_projection, jacobian = cv2.projectPoints(nose_3d, rot_vec, trans_vec, cam_matrix, dist_matrix)

          p1 = (int(nose_2d[0]), int(nose_2d[1]))
          p2 = (int(nose_3d_projection[0][0][0]), int(nose_3d_projection[0][0][1]))
          
          cv2.line(image, p1, p2, (255, 0, 0), 2)
			
          cv2.imshow('Head Pose Estimation', image)
        num += 1

    if cv2.waitKey(5) & 0xFF == 27:
      break

cap.release()

body.append(direction)
body.append(x1)
body.append(y1)
body.append(z1)

with open("landmark.csv", "w", newline="") as f:
  w = csv.writer(f, delimiter=",")
  w.writerow(time)
  for i in body:
    w.writerow(i)
```
向きと座標の値は一致してない可能性あります。
```data.csv
time,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171
direction,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Looking Left,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Forward,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right,Looking Right
x,12.30503930191994,15.035863436494434,15.465761315790594,15.978778319303856,15.703606770307694,14.719691878407552,14.141025154720284,12.695678567324947,12.704309714450744,11.405427608422292,9.806524355608007,7.780287043757212,6.686355464429891,5.448637692948496,4.344174607301632,2.7302552896218004,0.04181318581279104,-0.713933422384728,-2.6920735924819446,-4.835409643678076,-5.3202977145744885,-2.423883601966424,-1.2925344943626464,-1.7868682005394825,-0.363930001111502,4.843494892133991,6.909290381473953,6.929386030338765,7.865693337226774,10.921023652564196,12.491555378037761,13.776882212187735,15.192484398033624,15.110088440298385,17.648814075555563,16.87046668412305,16.881750790567615,16.225757470724936,16.666514739079524,16.18801837046211,15.54184209381961,15.628572456614949,15.503942615922746,15.455359652273906,15.672820268465223,16.688901172185716,17.343452962495725,18.69498664920249,20.058438457072214,20.004974709433604,19.99390537609492,20.811353544715768,19.671886258649554,19.787043175625243,20.598127657757733,21.502080960890492,21.44567464486578,23.648762285202643,25.44083194496038,27.152780911632824,28.845576817076054,31.55300708299792,32.217844321350576,33.273850951797186,32.011355224345294,32.347392431191366,29.805979074524927,30.18903035847762,30.01660699317595,27.85512379206571,26.626724326341456,26.000973161337438,24.95003338867846,22.009374035788277,21.43048521864148,23.031368697128386,20.684797164684493,20.902178524531095,19.67258718222981,18.77619808860214,19.35217797864008,19.690299946282284,19.669185726211083,19.723854516080998,20.07256373199355,19.878509239992642,20.468881691354625,19.919080893186106,20.2417334631249,19.773364127990718,20.573067828724,19.769482922238325,20.74576700271413,19.770264783478655,19.00025151409903,19.609201282175135,18.999828098751923,19.85916322754293,19.225986490026486,20.44383042710674,19.859403081594532,19.11304143899586,18.833538299633343,20.11609231167938,19.56777459511437,18.294825294571297,20.11941320936499,19.567455016394394,18.612756015513092,19.649822788110885,18.624975644291226,19.204204197081047,19.085562645827086,18.359443225580094,18.634031806937166,19.708434446989497,19.372200249979787,18.59282526648551,18.85667886852943,19.243329848251378,18.592849998006947,17.699624070193426,19.036996062743196,18.436103090744865,19.07351271444759,19.38513669444894,18.716384671753143,18.866647933264797,19.481225828184662,19.827328015635175,20.196986024527448,19.338474132154566,19.67354504352663,17.81125695813317,18.942022942511592,19.042574253191113,18.46491544264073,18.95923975702461,19.325022172162583,19.86847917796869,19.44907178015493,19.116641726522058,20.428179924805896,20.052849967870593,19.58366063349549,19.364277788919697,18.90343908645153,18.817289885171217,19.128167365846444,18.78820862803137,18.44267228116485,18.588934582148326,18.44858790136253,18.62355697447336,18.67758008598752,18.372651040521152,18.99899905063857,19.144592010276117,18.798458522572712,18.9409009072849,18.525348610916165,18.938940442287112,19.007119268728182,19.56789303271841,19.714779496659737,19.786036157142735,19.618779824837315,19.656639612910237,19.117266630101444,18.710461820370956,18.95206915914924,19.127389526273046
y,-1.0666780537719893,0.8513231042441293,1.9740294719219766,3.772458126848256,4.972949570228553,5.502401617834088,6.256303084818299,6.968503160480711,6.547568304920697,6.986607496632667,6.869843745336696,6.610723086668256,6.077940508989665,5.836369939821536,4.926241240020505,3.4038982021931834,2.020922797076833,0.19168233200304816,-2.441935975406771,-6.7010228434314145,-9.80490944920144,-12.521087937117994,-13.039636989376064,-13.101937547041167,-12.943373125658333,-12.520973542147914,-12.746742457311955,-13.460591376146494,-13.060108308947965,-13.518977478419352,-13.49678591730449,-14.122832972026398,-12.787189844799853,-14.587596359049435,-14.135709418935374,-14.691840700847795,-15.039333101039631,-14.933254066487658,-13.905742969013204,-12.832574596870025,-10.468499008259784,-8.520993467978046,-8.317727925539108,-5.243325327580324,-2.472001687603084,-0.8001444154201456,2.593373365083389,3.2125499205246686,5.502294243539135,6.4792464445017615,8.716425124911407,10.938423148137424,12.425281107317916,12.865811268266327,15.829690896976222,14.855744923773251,15.61302718605047,14.919298263182013,14.068585996288663,12.86411248708697,9.855134068469035,8.220468104904239,8.45830778175319,7.92452581450878,7.703496753926721,7.532151883968838,8.280852538739444,8.668587612185322,9.281425398345949,11.13053454484447,11.877378535154644,12.299294420878713,14.78076090380491,14.903776872097602,15.220014824974857,15.150872732214953,15.035044208185282,15.740392623096032,15.376393801600127,15.117785785933323,15.137036839433529,15.476634109197024,15.342718638311766,15.226864139118547,15.32293990402918,14.632143584625576,14.874464189655429,15.0375939885701,14.995499593481632,15.023163531088585,15.365829017335367,14.969777867293814,15.620668246430338,15.463052741787084,14.759115522499325,15.165669530860983,14.933149242637203,15.140170466141942,14.76611904848534,15.246134081321328,15.242971920466564,15.090687301099065,15.270650478686404,15.338156946889855,15.454845105347873,14.777310124858433,15.510191221794281,15.250588457452182,15.32928013857279,15.221002451985065,15.235089570762584,15.201398978290433,15.408386367774064,15.325576497748349,15.42407739624437,15.137986967012305,15.310059483909985,15.547674836541566,15.66790531885066,15.957129028300844,15.671800892245834,14.891254741158647,15.600834577242537,15.368048685020357,15.89157918034446,15.740066738898276,15.512470522050073,15.529469730076842,16.265125116923414,15.940924300960113,16.229159467425347,15.643035090410212,16.16830127695901,15.609654623452473,15.39024315237604,15.276291207855891,14.853799230916303,15.005619012448916,15.215301244102594,15.149243368139173,15.06265456592901,14.551329896783052,15.612398336401661,15.102182626446819,14.45839221660517,15.021364109364288,14.671407277615845,15.293569384366853,15.496955423588163,14.936665668490841,15.053959700147445,14.936878368300688,15.053080186725603,14.862720008252408,14.874844755618632,15.11427376860448,15.280416778190038,15.423173708788909,15.5983057530865,15.691940511500228,15.403955749616443,15.94117231091855,15.919097355272479,16.16351604505423,16.582337994442607,16.146284004754243,16.032379914001584,16.190365579123373,15.47701738637104,15.508601974980328,15.763357244893276,16.009086277467613
z,0.34266587164689055,0.29457182768094237,0.26241271902111574,0.18762619782511522,0.14057981647738022,0.10910101602834797,0.08619091192344884,0.06808736861768779,0.06476518667095976,0.058258831127791864,0.059024839399746135,0.05388775778069294,0.056539765917955294,0.05664576529168035,0.05789691343904751,0.05187625348555506,0.03050755813243139,0.024604044138202337,-0.031108568775834306,-0.09863574770952957,-0.16005530389766312,-0.08835153968861857,0.1065009443031956,0.1007231244343159,0.33050831244745016,0.9488059213894671,1.1911274582150277,1.1325970186645646,1.0894786284917,1.4201407200109006,1.4640297408485357,1.4273749847367097,1.5804345435013798,1.4403493835487544,1.4074902438798405,1.0919083226360664,0.7556857681534301,0.6255758347922451,0.5465539609203544,0.49833754222937854,0.3946333689789701,0.4096759235994754,0.38200360356080515,0.42569020850949474,0.4047270939015695,0.3900275375928784,0.34745231553762057,0.2866353377820147,0.22711735230331423,0.09846367992090069,-0.025777834311121937,-0.1650214695413622,-0.23944530132424033,-0.3353512376995573,-0.43928564221907007,-0.6299238295177415,-0.6074923702640158,-0.8746807128009101,-1.157559371559083,-1.5069617366701344,-1.8877882288189114,-2.4522494499625083,-2.6655626935972307,-2.857608032811241,-2.743573799555133,-2.7265820797726033,-2.382462226798589,-2.254008430408796,-2.236907766703437,-1.8445974863401993,-1.5396795444330293,-1.5103463149997358,-1.2660183323515677,-0.939525998547113,-0.7949528913998635,-0.8478156844784438,-0.7323402070131808,-0.6722879242421226,-0.6081231675198399,-0.5242625421603465,-0.5344130236459014,-0.5133024274590808,-0.5332715368174166,-0.5213673808611886,-0.4950349257344221,-0.47297801579759235,-0.48084193643021944,-0.4672691519256182,-0.45008202034561134,-0.43628498828232604,-0.41933997724012145,-0.43204549883056875,-0.4366866850228028,-0.42709552865098305,-0.4283191683107914,-0.4168252869334603,-0.416347936541454,-0.42980832420855547,-0.4293201044272325,-0.4414980099491012,-0.43060664360213247,-0.3989013827797757,-0.4133786890409614,-0.41333560897166094,-0.4010129966328586,-0.40709933772564033,-0.42032700994408984,-0.43149074088107603,-0.43396061492479016,-0.42570185916045067,-0.40140233344583065,-0.40847240950771646,-0.4032719382581513,-0.4025655033084921,-0.41556041675884536,-0.42901424452448617,-0.45330702274731455,-0.46780319026791445,-0.472629753193583,-0.4753344860854478,-0.47706051311517783,-0.4411948111534572,-0.4849947870563197,-0.48704445389126483,-0.4810764600472955,-0.4977594960260585,-0.49465607165238357,-0.47488223068432944,-0.49200830931630285,-0.5244611690300678,-0.4983180162593203,-0.48408780352372466,-0.5028793871980893,-0.46718311934938356,-0.45156039045819674,-0.45582687098635927,-0.4370606708802651,-0.4392412317364793,-0.4598859898197659,-0.4640053949266599,-0.477667762145968,-0.4714770384469325,-0.49541253665874124,-0.4832153843399059,-0.46724003809151254,-0.46205155218239047,-0.4575949985543273,-0.4442490661333802,-0.43850387773573757,-0.4212479330027197,-0.43248116950990917,-0.4162472943249853,-0.4208939012260931,-0.4218153782971054,-0.4131890802752085,-0.4224887328040333,-0.407822705265116,-0.41178493664790844,-0.3911158510074076,-0.3997149893631745,-0.40119223032735674,-0.3936777845775575,-0.38469647607966767,-0.3912506058757844,-0.39687173283779464,-0.395325183303099,-0.4091222365270246,-0.4067720092099445,-0.396018651653799,-0.38850663113359996,-0.3873118512280936,-0.3810401466888546

```
